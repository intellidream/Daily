@namespace Daily.Components.Shared

<MudExpansionPanels Elevation="0" DisableBorders="true" Dense="true" Gutters="false" Class="compact-selector-panel pa-0" Style="min-width: 150px; background: transparent;">
    <MudExpansionPanel Text="@Value" @bind-IsExpanded="_isExpanded" Dense="true" Class="pa-0" Style="background: transparent;" Icon="@GetIcon(Value)">
        <MudList T="string" Clickable="true" Dense="true" DisablePadding="true">
            @foreach (var item in Items)
            {
                <MudListItem OnClick="@(() => OnItemSelected(item))" Dense="true" Icon="@GetIcon(item)">
                    <MudText Color="@(item == Value ? Color.Primary : Color.Inherit)" Typo="Typo.body2" Class="@(item == Value ? "font-weight-bold" : "")">
                        @item
                    </MudText>
                </MudListItem>
            }
        </MudList>
    </MudExpansionPanel>
</MudExpansionPanels>

@code {
    [Parameter] public string Value { get; set; }
    [Parameter] public EventCallback<string> ValueChanged { get; set; }
    [Parameter] public List<string> Items { get; set; } = new();

    private bool _isExpanded;

    private async Task OnItemSelected(string item)
    {
        Value = item;
        await ValueChanged.InvokeAsync(item);
        _isExpanded = false;
    }

    private string GetIcon(string item)
    {
        return item switch
        {
            "US Stocks" => Icons.Material.Filled.CandlestickChart,
            "Crypto" => Icons.Material.Filled.CurrencyBitcoin,
            "Forex" => Icons.Material.Filled.CurrencyExchange,
            _ => Icons.Material.Filled.List
        };
    }
}
